# 较高版本Linux发行版中Python使用外部管理而pip失效

## 一、`pip` 与 `apt` 包管理器的区别

### （一）所属系统层面
- **`pip`**：Python 语言层面的包管理器，只要安装了 Python 就能使用，独立于操作系统的包管理体系。
- **`apt`**：Debian 及其衍生发行版（如 Ubuntu）的操作系统级包管理器，用于管理系统软件包。

### （二）管理范围和目标
- **`pip`**：主要关注 Python 项目的开发和运行需求，可从 Python Package Index（PyPI）下载并安装各种 Python 库，支持细粒度的版本控制，能为不同项目安装不同版本的库。例如，一个项目可能需要 `Django` 库的 3.2 版本，另一个项目可能需要 4.0 版本，使用 `pip` 可轻松实现。
- **`apt`**：侧重于系统的稳定性和兼容性，安装的软件包经过操作系统发行商的测试和验证，确保与系统其他组件正常协同工作。安装的 Python 包是系统级、经过打包和优化的版本。

### （三）依赖处理方式
- **`pip`**：主要处理 Python 包之间的依赖关系，自动下载并安装包所依赖的其他 Python 包，但对系统级依赖处理能力较弱。若一个 Python 包依赖某个系统库，`pip` 本身无法直接安装。
- **`apt`**：全面考虑软件包的所有依赖关系，包括系统级依赖和 Python 包依赖，自动解决包所需的所有依赖，确保软件在系统中正常运行。

### （四）权限和环境影响
- **`pip`**：在虚拟环境中使用，普通用户无需管理员权限，不影响系统全局 Python 环境；在系统级 Python 环境中使用可能需管理员权限（使用 `sudo`），可能与系统包管理器管理的包产生冲突。
- **`apt`**：通常需要管理员权限（使用 `sudo`）执行安装、升级和卸载操作，安装的包影响整个系统，对所有用户可见。

## 二、“外部管理” 的含义

### （一）定义
“外部管理” 是相对于 Python 自身的 `pip` 包管理体系而言的。在一些现代 Linux 发行版中，为保证系统稳定性和一致性，避免 `pip` 和系统包管理器冲突，使用操作系统级的包管理器（如 `apt`）来管理 Python 解释器及其相关的系统级 Python 包。

### （二）影响和注意事项
1. **冲突避免**：通过系统包管理器统一管理 Python 包，可避免因 `pip` 和系统包管理器对同一包进行不同版本管理导致的冲突，确保系统稳定性。
2. **虚拟环境的重要性**：在外部管理环境下，为满足不同 Python 项目对包版本的不同需求，使用虚拟环境（如 `venv` 或 `conda`）很重要。虚拟环境可创建独立的 Python 运行环境，在其中可自由使用 `pip` 管理项目所需特定版本的 Python 包，不影响系统全局 Python 环境。
3. **权限问题**：使用系统包管理器（如 `apt`）通常需管理员权限（使用 `sudo`），在虚拟环境中使用 `pip` 一般普通用户权限即可。进行包管理操作时，需根据具体情况正确使用相应权限。

## 三、`pip` 使用时 `error: externally - managed - environment` 错误

### （一）产生原因
现代一些 Linux 发行版采用外部管理的 Python 环境，系统的 Python 解释器及其包由操作系统的包管理器管理。当尝试直接使用 `pip` 在系统 Python 环境里安装包时，会出现此错误。

### （二）解决办法

#### 1. 使用虚拟环境
- **使用 `venv` 模块（Python 内置）**
```bash
# 创建虚拟环境
python -m venv myenv
# 激活虚拟环境
# 在 Linux 或 macOS 上
source myenv/bin/activate
# 在 Windows 上
myenv\Scripts\activate
# 现在可以在虚拟环境中使用 pip 安装包
pip install package_name

#### 2. 使用系统包管理器
```bash
sudo apt install python3 - package_name
